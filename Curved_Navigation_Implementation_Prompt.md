# 🧭 Analytical & Safe Implementation Prompt — “Curved Navigation Redesign for MySalesApp (Expo SDK 54)”

🎯 **OBJECTIVE**
Implement a **modern curved bottom navigation system** and a **two-level navigation hierarchy** for the existing **Expo-managed React Native app (Expo SDK 54, React Native 0.81.x)**.  
The redesign introduces **a curved bottom tab bar** (as shown in the reference image), brand-based navigation (Playmobil, Kivos, John), a structured KPI-based Home screen, and the **Supermarket Order Flow** inside supported brands — while keeping **all business logic and Firestore collections fully intact**.

The code generated by Codex should focus on safe implementation, maintaining proper **UTF‑8 encoding**, correct **JavaScript syntax**, and a non-destructive integration with the current app structure.

---

## 🧱 FRAMEWORK & STACK
- Expo SDK 54 (managed workflow)
- React Navigation v6 (`@react-navigation/native`, `@react-navigation/bottom-tabs`)
- Functional React components with Hooks
- `SafeAreaView` for all screen roots
- `@expo/vector-icons` (Ionicons)
- `react-native-svg` for curved background drawing
- Responsive design using `useWindowDimensions` and `useSafeAreaInsets`

---

## 🎨 VISUAL THEME
**Primary color:** `#1976d2`  
**Accent color:** `#2196f3`  
**Background:** `#f5f7fa`  
**Active tab:** `#1976d2`  
**Inactive tab:** `#6b7280`  
**Curved bar:** White with soft shadow  
**Floating button:** Circular (68dp), blue background, white `add` icon  
**Text:** Primary `#0d1b2a`, Secondary `#5f6c7b`  
**Encoding:** UTF‑8 for all files  

---

## 🗺️ NAVIGATION STRUCTURE OVERVIEW

### LEVEL 1 — MAIN APP (GLOBAL)
`MainTabsNavigator.js` handles curved bottom navigation between Home and the three brand modules.

| Position | Label | Component | Icon / Asset | Purpose |
|-----------|--------|------------|---------------|----------|
| Left 1 | 🏠 Home | `MainHomeScreen` | `Ionicons home-outline` | User info, KPIs, brand selection |
| Center | ➕ | (reserved FAB) | `add` | Optional global action |
| Right 1 | Playmobil | `PlaymobilHomeScreen` | `assets/playmobil_logo.ico` | Playmobil brand dashboard |
| Right 2 | Kivos | `KivosHomeScreen` | `assets/kivos_logo.ico` | Kivos brand dashboard |
| Right 3 | John | `JohnHomeScreen` | `assets/john_hellas_logo.ico` | John Hellas brand dashboard |

**Behavior**
- Phones: 4 items + FAB  
- Tablets (≥700dp): 5 items + FAB  
- Curved bar drawn via `react-native-svg`  
- FAB offset ~30dp from bottom + safe inset

---

### LEVEL 2 — BRAND NAVIGATION
Each brand module uses `BrandTabsNavigator.js` with a **4 + 1 structure**:

| Position | Label | Component | Icon | Purpose |
|-----------|--------|------------|--------|----------|
| Left 1 | 🏠 Home | `BrandHomeScreen` | `home-outline` | Brand KPIs, info, quick actions |
| Left 2 | 📦 Products | `ProductsScreen` | `cube-outline` | Brand product catalog |
| Center | ➕ New Order | `OrderScreen` (hidden route) | `add` | Create new standard order |
| Right 1 | 👥 Customers | `CustomersScreen` | `people-outline` | Brand customers list |
| Right 2 | 📖 Catalogues | `CataloguesScreen` | `book-outline` | Brand PDF / flipbook catalogues |
| (Tablet only) | 📊 Orders Mgmt | `OrdersMgmtScreen` | `stats-chart-outline` | Manage existing orders |

Each brand retains its data flow, Firestore references, and local database sync.

---

## 🛒 SUPERMARKET ORDER FLOW (Brand-Specific)
Some brands (e.g., **John Hellas**, later **Playmobil**) include a **Supermarket Order Flow** — a specialized type of order linked to brand-specific supermarket data.

**Access:**
- From each brand’s **Home screen → Quick Actions → 🛒 Παραγγελία Supermarket**
- Opens `SuperMarketOrderFlowScreen.js`
- Not part of the bottom navigation bar

**Collections Used:**
- `supermarket_stores` → contains the brand they belong to and their supermarket company
- `supermarket_listings` → lists the products available per store and brand
- Orders saved into `orders_{brand}_supermarket` (e.g. `orders_john_supermarket`, `orders_playmobil_supermarket`)

**Logic Flow:**
1. User selects a **store** from `supermarket_stores` filtered by current brand.  
2. App loads product categories from `supermarket_listings` that belong to the selected store + brand.  
3. User adds products and quantities within categories.  
4. Order is stored to `orders_{brand}_supermarket`.  
5. Orders appear in `OrdersMgmtScreen` labeled as **Supermarket Order**.

**File:**  
`src/screens/SuperMarketOrderFlowScreen.js`

**Visibility:**  
Conditional → only for brands that have supermarket listings enabled.

**Navigation Path:**
```
BrandHomeScreen → SuperMarketOrderFlowScreen → (Order summary/export)
```

---

## 🔗 NAVIGATION LAYOUT & SCREEN CONNECTIONS

```
AppNavigator (Stack)
 ├── SplashScreen / LoginScreen (optional)
 ├── MainTabsNavigator
 │     ├── MainHomeScreen
 │     ├── PlaymobilHomeScreen → BrandTabsNavigator
 │     │     ├── BrandHomeScreen
 │     │     ├── ProductsScreen
 │     │     ├── CustomersScreen
 │     │     ├── CataloguesScreen
 │     │     ├── OrderScreen (FAB trigger)
 │     │     ├── SuperMarketOrderFlowScreen (if enabled)
 │     │     └── OrdersMgmtScreen (tablet only)
 │     ├── KivosHomeScreen → BrandTabsNavigator (same structure, no supermarket flow)
 │     ├── JohnHomeScreen → BrandTabsNavigator (with supermarket flow)
 │
 └── Modals / UserMenu (Profile, Sync, Settings, Exit)
```

### Connectivity Table

| From | Action | Leads To | Navigator |
|------|---------|----------|------------|
| MainHomeScreen | Tap Playmobil | PlaymobilHomeScreen | MainTabsNavigator |
| MainHomeScreen | Tap Kivos | KivosHomeScreen | MainTabsNavigator |
| MainHomeScreen | Tap John | JohnHomeScreen | MainTabsNavigator |
| BrandHomeScreen | Tap ➕ FAB | OrderScreen | BrandTabsNavigator |
| BrandHomeScreen | Tap 🛒 Supermarket Order | SuperMarketOrderFlowScreen | BrandTabsNavigator |
| CustomersScreen | Tap “New Order” | OrderScreen | BrandTabsNavigator |
| OrderScreen | Export | Back to BrandHomeScreen | BrandTabsNavigator |
| Any screen | Tap User Icon | UserMenu | Modal |

---

## 🏠 MAIN HOME SCREEN LAYOUT
`MainHomeScreen.js` displays:
1. **User Info Card**
   - Salesman name, area, connection, last sync time
2. **KPIs Section**
   - Title “KPIs” (no placeholder data; connect to live metrics later)
3. **Brand Cards**
   - Playmobil → `PlaymobilHomeScreen`
   - Kivos → `KivosHomeScreen`
   - John → `JohnHomeScreen`
4. **Optional Quick Actions**
   - Shortcuts like “Sync Data” or “Orders Management”

---

## ⚙️ FILE STRUCTURE

```
src/
 ├── navigation/
 │     ├── AppNavigator.js
 │     ├── MainTabsNavigator.js
 │     ├── BrandTabsNavigator.js
 ├── components/
 │     ├── CurvedBottomBar.js
 │     ├── KPIBox.js
 │     ├── SalesmanInfoCard.js
 │     └── QuickActionButton.js
 ├── screens/
 │     ├── MainHomeScreen.js
 │     ├── PlaymobilHomeScreen.js
 │     ├── KivosHomeScreen.js
 │     ├── JohnHomeScreen.js
 │     ├── BrandHomeScreen.js
 │     ├── ProductsScreen.js
 │     ├── CustomersScreen.js
 │     ├── CataloguesScreen.js
 │     ├── OrderScreen.js
 │     ├── OrdersMgmtScreen.js
 │     └── SuperMarketOrderFlowScreen.js
 ├── assets/
 │     ├── playmobil_logo.ico
 │     ├── kivos_logo.ico
 │     └── john_hellas_logo.ico
 └── theme/
       └── colors.js
```

---

## 🧩 SAFETY & INTEGRATION RULES
1. **Never remove existing logic or screens.** Only wrap them in new navigators.  
2. Preserve route names to keep all existing `navigation.navigate()` references valid.  
3. **Set `unmountOnBlur: false`** for order-related screens to prevent data loss.  
4. Apply SafeAreaInsets in curved bar and all navigators.  
5. Responsive behavior:
   - `width < 700` → 4 + 1 layout  
   - `width ≥ 700` → 5 + 1 layout  
6. UTF‑8 encoding for all files to support Greek text.  
7. Use headerShown:false to avoid duplicate headers.  
8. Use `.ico` assets for brand icons.  
9. “KPIs” section contains no placeholders.  
10. “Supermarket Order Flow” visible only for supported brands.

---

## 🧠 TASKS FOR CODEX
1. Implement `CurvedBottomBar.js` (reusable SVG curved bar + FAB).  
2. Create `MainTabsNavigator.js` linking Home + brands using `.ico` icons.  
3. Create `BrandTabsNavigator.js` implementing 4 + 1 layout with conditional Supermarket Flow support.  
4. Build `SuperMarketOrderFlowScreen.js` using Firestore collections:  
   - `supermarket_stores` (brand/company filter)  
   - `supermarket_listings` (store listings)  
   - `orders_{brand}_supermarket` for order storage  
5. Keep all Firestore/AsyncStorage logic intact.  
6. Comment code clearly (encoding, safety notes, preserved logic).  
7. Test on Galaxy A54, S24 Ultra, Lenovo Tab M11.

---

## ✅ EXPECTED OUTCOME
- Fully functional curved navigation system.  
- Two-level hierarchy (global + brand).  
- Supermarket Order Flow integrated per brand, not global.  
- All features and Firestore logic preserved.  
- Blue-themed responsive UI.  
- Clean JS syntax, UTF‑8 safe source, no placeholder data.
