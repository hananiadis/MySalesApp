# ğŸ§­ Analytical & Safe Implementation Prompt â€” â€œCurved Navigation Redesign for MySalesApp (Expo SDK 54)â€

ğŸ¯ **OBJECTIVE**
Implement a **modern curved bottom navigation system** and a **two-level navigation hierarchy** for the existing **Expo-managed React Native app (Expo SDK 54, React Native 0.81.x)**.  
The redesign introduces **a curved bottom tab bar** (as shown in the reference image), brand-based navigation (Playmobil, Kivos, John), a structured KPI-based Home screen, and the **Supermarket Order Flow** inside supported brands â€” while keeping **all business logic and Firestore collections fully intact**.

The code generated by Codex should focus on safe implementation, maintaining proper **UTFâ€‘8 encoding**, correct **JavaScript syntax**, and a non-destructive integration with the current app structure.

---

## ğŸ§± FRAMEWORK & STACK
- Expo SDK 54 (managed workflow)
- React Navigation v6 (`@react-navigation/native`, `@react-navigation/bottom-tabs`)
- Functional React components with Hooks
- `SafeAreaView` for all screen roots
- `@expo/vector-icons` (Ionicons)
- `react-native-svg` for curved background drawing
- Responsive design using `useWindowDimensions` and `useSafeAreaInsets`

---

## ğŸ¨ VISUAL THEME
**Primary color:** `#1976d2`  
**Accent color:** `#2196f3`  
**Background:** `#f5f7fa`  
**Active tab:** `#1976d2`  
**Inactive tab:** `#6b7280`  
**Curved bar:** White with soft shadow  
**Floating button:** Circular (68dp), blue background, white `add` icon  
**Text:** Primary `#0d1b2a`, Secondary `#5f6c7b`  
**Encoding:** UTFâ€‘8 for all files  

---

## ğŸ—ºï¸ NAVIGATION STRUCTURE OVERVIEW

### LEVEL 1 â€” MAIN APP (GLOBAL)
`MainTabsNavigator.js` handles curved bottom navigation between Home and the three brand modules.

| Position | Label | Component | Icon / Asset | Purpose |
|-----------|--------|------------|---------------|----------|
| Left 1 | ğŸ  Home | `MainHomeScreen` | `Ionicons home-outline` | User info, KPIs, brand selection |
| Center | â• | (reserved FAB) | `add` | Optional global action |
| Right 1 | Playmobil | `PlaymobilHomeScreen` | `assets/playmobil_logo.ico` | Playmobil brand dashboard |
| Right 2 | Kivos | `KivosHomeScreen` | `assets/kivos_logo.ico` | Kivos brand dashboard |
| Right 3 | John | `JohnHomeScreen` | `assets/john_hellas_logo.ico` | John Hellas brand dashboard |

**Behavior**
- Phones: 4 items + FAB  
- Tablets (â‰¥700dp): 5 items + FAB  
- Curved bar drawn via `react-native-svg`  
- FAB offset ~30dp from bottom + safe inset

---

### LEVEL 2 â€” BRAND NAVIGATION
Each brand module uses `BrandTabsNavigator.js` with a **4 + 1 structure**:

| Position | Label | Component | Icon | Purpose |
|-----------|--------|------------|--------|----------|
| Left 1 | ğŸ  Home | `BrandHomeScreen` | `home-outline` | Brand KPIs, info, quick actions |
| Left 2 | ğŸ“¦ Products | `ProductsScreen` | `cube-outline` | Brand product catalog |
| Center | â• New Order | `OrderScreen` (hidden route) | `add` | Create new standard order |
| Right 1 | ğŸ‘¥ Customers | `CustomersScreen` | `people-outline` | Brand customers list |
| Right 2 | ğŸ“– Catalogues | `CataloguesScreen` | `book-outline` | Brand PDF / flipbook catalogues |
| (Tablet only) | ğŸ“Š Orders Mgmt | `OrdersMgmtScreen` | `stats-chart-outline` | Manage existing orders |

Each brand retains its data flow, Firestore references, and local database sync.

---

## ğŸ›’ SUPERMARKET ORDER FLOW (Brand-Specific)
Some brands (e.g., **John Hellas**, later **Playmobil**) include a **Supermarket Order Flow** â€” a specialized type of order linked to brand-specific supermarket data.

**Access:**
- From each brandâ€™s **Home screen â†’ Quick Actions â†’ ğŸ›’ Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± Supermarket**
- Opens `SuperMarketOrderFlowScreen.js`
- Not part of the bottom navigation bar

**Collections Used:**
- `supermarket_stores` â†’ contains the brand they belong to and their supermarket company
- `supermarket_listings` â†’ lists the products available per store and brand
- Orders saved into `orders_{brand}_supermarket` (e.g. `orders_john_supermarket`, `orders_playmobil_supermarket`)

**Logic Flow:**
1. User selects a **store** from `supermarket_stores` filtered by current brand.  
2. App loads product categories from `supermarket_listings` that belong to the selected store + brand.  
3. User adds products and quantities within categories.  
4. Order is stored to `orders_{brand}_supermarket`.  
5. Orders appear in `OrdersMgmtScreen` labeled as **Supermarket Order**.

**File:**  
`src/screens/SuperMarketOrderFlowScreen.js`

**Visibility:**  
Conditional â†’ only for brands that have supermarket listings enabled.

**Navigation Path:**
```
BrandHomeScreen â†’ SuperMarketOrderFlowScreen â†’ (Order summary/export)
```

---

## ğŸ”— NAVIGATION LAYOUT & SCREEN CONNECTIONS

```
AppNavigator (Stack)
 â”œâ”€â”€ SplashScreen / LoginScreen (optional)
 â”œâ”€â”€ MainTabsNavigator
 â”‚     â”œâ”€â”€ MainHomeScreen
 â”‚     â”œâ”€â”€ PlaymobilHomeScreen â†’ BrandTabsNavigator
 â”‚     â”‚     â”œâ”€â”€ BrandHomeScreen
 â”‚     â”‚     â”œâ”€â”€ ProductsScreen
 â”‚     â”‚     â”œâ”€â”€ CustomersScreen
 â”‚     â”‚     â”œâ”€â”€ CataloguesScreen
 â”‚     â”‚     â”œâ”€â”€ OrderScreen (FAB trigger)
 â”‚     â”‚     â”œâ”€â”€ SuperMarketOrderFlowScreen (if enabled)
 â”‚     â”‚     â””â”€â”€ OrdersMgmtScreen (tablet only)
 â”‚     â”œâ”€â”€ KivosHomeScreen â†’ BrandTabsNavigator (same structure, no supermarket flow)
 â”‚     â”œâ”€â”€ JohnHomeScreen â†’ BrandTabsNavigator (with supermarket flow)
 â”‚
 â””â”€â”€ Modals / UserMenu (Profile, Sync, Settings, Exit)
```

### Connectivity Table

| From | Action | Leads To | Navigator |
|------|---------|----------|------------|
| MainHomeScreen | Tap Playmobil | PlaymobilHomeScreen | MainTabsNavigator |
| MainHomeScreen | Tap Kivos | KivosHomeScreen | MainTabsNavigator |
| MainHomeScreen | Tap John | JohnHomeScreen | MainTabsNavigator |
| BrandHomeScreen | Tap â• FAB | OrderScreen | BrandTabsNavigator |
| BrandHomeScreen | Tap ğŸ›’ Supermarket Order | SuperMarketOrderFlowScreen | BrandTabsNavigator |
| CustomersScreen | Tap â€œNew Orderâ€ | OrderScreen | BrandTabsNavigator |
| OrderScreen | Export | Back to BrandHomeScreen | BrandTabsNavigator |
| Any screen | Tap User Icon | UserMenu | Modal |

---

## ğŸ  MAIN HOME SCREEN LAYOUT
`MainHomeScreen.js` displays:
1. **User Info Card**
   - Salesman name, area, connection, last sync time
2. **KPIs Section**
   - Title â€œKPIsâ€ (no placeholder data; connect to live metrics later)
3. **Brand Cards**
   - Playmobil â†’ `PlaymobilHomeScreen`
   - Kivos â†’ `KivosHomeScreen`
   - John â†’ `JohnHomeScreen`
4. **Optional Quick Actions**
   - Shortcuts like â€œSync Dataâ€ or â€œOrders Managementâ€

---

## âš™ï¸ FILE STRUCTURE

```
src/
 â”œâ”€â”€ navigation/
 â”‚     â”œâ”€â”€ AppNavigator.js
 â”‚     â”œâ”€â”€ MainTabsNavigator.js
 â”‚     â”œâ”€â”€ BrandTabsNavigator.js
 â”œâ”€â”€ components/
 â”‚     â”œâ”€â”€ CurvedBottomBar.js
 â”‚     â”œâ”€â”€ KPIBox.js
 â”‚     â”œâ”€â”€ SalesmanInfoCard.js
 â”‚     â””â”€â”€ QuickActionButton.js
 â”œâ”€â”€ screens/
 â”‚     â”œâ”€â”€ MainHomeScreen.js
 â”‚     â”œâ”€â”€ PlaymobilHomeScreen.js
 â”‚     â”œâ”€â”€ KivosHomeScreen.js
 â”‚     â”œâ”€â”€ JohnHomeScreen.js
 â”‚     â”œâ”€â”€ BrandHomeScreen.js
 â”‚     â”œâ”€â”€ ProductsScreen.js
 â”‚     â”œâ”€â”€ CustomersScreen.js
 â”‚     â”œâ”€â”€ CataloguesScreen.js
 â”‚     â”œâ”€â”€ OrderScreen.js
 â”‚     â”œâ”€â”€ OrdersMgmtScreen.js
 â”‚     â””â”€â”€ SuperMarketOrderFlowScreen.js
 â”œâ”€â”€ assets/
 â”‚     â”œâ”€â”€ playmobil_logo.ico
 â”‚     â”œâ”€â”€ kivos_logo.ico
 â”‚     â””â”€â”€ john_hellas_logo.ico
 â””â”€â”€ theme/
       â””â”€â”€ colors.js
```

---

## ğŸ§© SAFETY & INTEGRATION RULES
1. **Never remove existing logic or screens.** Only wrap them in new navigators.  
2. Preserve route names to keep all existing `navigation.navigate()` references valid.  
3. **Set `unmountOnBlur: false`** for order-related screens to prevent data loss.  
4. Apply SafeAreaInsets in curved bar and all navigators.  
5. Responsive behavior:
   - `width < 700` â†’ 4 + 1 layout  
   - `width â‰¥ 700` â†’ 5 + 1 layout  
6. UTFâ€‘8 encoding for all files to support Greek text.  
7. Use headerShown:false to avoid duplicate headers.  
8. Use `.ico` assets for brand icons.  
9. â€œKPIsâ€ section contains no placeholders.  
10. â€œSupermarket Order Flowâ€ visible only for supported brands.

---

## ğŸ§  TASKS FOR CODEX
1. Implement `CurvedBottomBar.js` (reusable SVG curved bar + FAB).  
2. Create `MainTabsNavigator.js` linking Home + brands using `.ico` icons.  
3. Create `BrandTabsNavigator.js` implementing 4 + 1 layout with conditional Supermarket Flow support.  
4. Build `SuperMarketOrderFlowScreen.js` using Firestore collections:  
   - `supermarket_stores` (brand/company filter)  
   - `supermarket_listings` (store listings)  
   - `orders_{brand}_supermarket` for order storage  
5. Keep all Firestore/AsyncStorage logic intact.  
6. Comment code clearly (encoding, safety notes, preserved logic).  
7. Test on Galaxy A54, S24 Ultra, Lenovo Tab M11.

---

## âœ… EXPECTED OUTCOME
- Fully functional curved navigation system.  
- Two-level hierarchy (global + brand).  
- Supermarket Order Flow integrated per brand, not global.  
- All features and Firestore logic preserved.  
- Blue-themed responsive UI.  
- Clean JS syntax, UTFâ€‘8 safe source, no placeholder data.
